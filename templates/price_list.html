<!DOCTYPE html>
<html>
<head>
    <title>Real-time Data Display</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <div id="navbar"></div>
    <h1>Real-time Data from PostgreSQL Database</h1>
    <table>
        <thead>
            <tr>
                <th>Source Currency</th>
                <th>Target Currency</th>
                <th>Date</th>
                <th>BID</th>
                <th>ASK</th>
            </tr>
        </thead>
        <tbody id="data-table">
            <!-- Data will be dynamically updated here -->
        </tbody>
    </table>

    <script>
        // Fetch the navbar.html content using Fetch API
        fetch('navbar.html')
            .then(response => response.text())
            .then(data => {
                // Insert the navbar HTML into the div with id="navbar"
                document.getElementById('navbar').innerHTML = data;
            })
            .catch(error => console.error('Error fetching navbar:', error));
    </script>

    <script>
        function fetchData() {
            $.ajax({
                url: '/price_data', // Endpoint to fetch data from Flask
                type: 'GET',
                success: function(response) {
                    console.log('Received data:', response.data); // Log received data
                    updateUI(response.data);
                },
                error: function(error) {
                    console.error('Error fetching data:', error);
                }
            });
        }

        function updateUI(data) {
            $('#data-table').empty(); // Clear existing data

            // Display new data
            data.forEach(function(item) {
                $('#data-table').append(`
                    <tr>
                        <td>${item[0]}</td>
                        <td>${item[1]}</td>
                        <td>${item[3]}</td>
                        <td>${item[5]}</td>
                        <td>${item[7]}</td>
                    </tr>
                `);
            });
        }

        // Fetch data every 5 seconds (adjust as needed)
        setInterval(fetchData, 1000); // Polling interval: 5000 milliseconds (5 seconds)

        // Initial fetch when the page loads
        $(document).ready(function() {
            fetchData();
        });
    </script>
</body>
</html>
